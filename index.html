<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÊïôÂ∏àÂ∑•ÂÖ∑ÁÆ±</title>
    <link rel="stylesheet" href="styles.css">
    <script src="student-manager.js"></script>
    <style>
        .container {
            max-width: 1300px;
            margin: 2.5rem auto;
            padding: 0 1.5rem;
        }
        
        .instructions {
            background: rgba(227, 242, 253, 0.8);
            border-radius: 16px;
            padding: 2rem;
            margin-top: 2.5rem;
            text-align: left;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(179, 219, 255, 0.5);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
        }
        
        .instructions h3 {
            color: #182848;
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
            font-weight: 700;
        }
        
        .instructions ol {
            padding-left: 2rem;
        }
        
        .instructions li {
            margin-bottom: 0.8rem;
            line-height: 1.7;
            font-size: 1.1rem;
            color: #444;
        }
        
        .instructions strong {
            color: #4b6cb7;
            font-weight: 600;
        }
        
        /* Â∑•ÂÖ∑Âç°ÁâáÂõæÊ†á */
        .tool-icon {
            font-size: 3rem;
            margin-bottom: 1.2rem;
            color: #4b6cb7;
        }
        
        /* Â≠¶ÁîüÁÆ°ÁêÜÂå∫Âüü */
        .student-management {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            margin: 2.5rem 0;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 0, 0, 0.05);
            display: none; /* ÈªòËÆ§ÈöêËóè */
        }
        
        .student-management.visible {
            display: block;
        }
        
        .student-management h2 {
            color: #182848;
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
            font-weight: 700;
            text-align: center;
        }
        
        .student-input-section {
            margin-bottom: 2rem;
        }
        
        .input-group {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        
        .input-group input {
            flex: 1;
            min-width: 150px;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }
        
        .btn {
            background: linear-gradient(135deg, #4b6cb7 0%, #182848 100%);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            font-size: 1rem;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            box-shadow: 0 4px 10px rgba(75, 108, 183, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(75, 108, 183, 0.5);
        }
        
        .btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .btn.add {
            background: linear-gradient(135deg, #4CAF50, #8BC34A);
        }
        
        .btn.import {
            background: linear-gradient(135deg, #9C27B0, #E040FB);
        }
        
        .btn.clear {
            background: linear-gradient(135deg, #FF5722, #FF9800);
        }
        
        .btn.toggle-students {
            background: linear-gradient(135deg, #2196F3, #21CBF3);
            display: block;
            margin: 1.5rem auto;
            padding: 1rem 2rem;
            font-size: 1.1rem;
        }
        
        .btn.feedback {
            background: linear-gradient(135deg, #FF9800, #FFC107);
            display: block;
            margin: 1rem auto;
            padding: 0.8rem 1.5rem;
            font-size: 1rem;
        }
        
        .batch-import {
            margin: 1rem 0;
            padding: 1rem;
            background: #e3f2fd;
            border-radius: 8px;
        }
        
        .batch-import h3 {
            color: #182848;
            margin-bottom: 0.5rem;
        }
        
        .batch-import textarea {
            width: 100%;
            min-height: 100px;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: monospace;
            margin-bottom: 1rem;
        }
        
        .file-import {
            margin: 1rem 0;
            padding: 1rem;
            background: #e3f2fd;
            border-radius: 8px;
        }
        
        .file-import h3 {
            color: #182848;
            margin-bottom: 0.5rem;
        }
        
        .file-import input {
            width: 100%;
            margin-bottom: 1rem;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .student-list-container {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1rem;
            background: #f8f9fa;
            margin-top: 1rem;
        }
        
        .student-item {
            padding: 0.8rem;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .student-item:last-child {
            border-bottom: none;
        }
        
        .student-info {
            flex: 1;
        }
        
        .student-id {
            font-weight: bold;
            color: #4b6cb7;
        }
        
        .remove-student {
            background: #ff416c;
            color: white;
            border: none;
            padding: 0.3rem 0.6rem;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .student-summary {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }
        
        .summary-card {
            background: #e3f2fd;
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            min-width: 150px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .summary-value {
            font-size: 2rem;
            font-weight: bold;
            color: #182848;
        }
        
        .summary-label {
            font-size: 1rem;
            color: #555;
        }
        
        /* ÂèçÈ¶àÊ®°ÊÄÅÊ°Ü */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .modal-title {
            font-size: 1.5rem;
            color: #182848;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
        }
        
        .close-modal:hover {
            color: #ff416c;
        }
        
        .feedback-form {
            margin-bottom: 1rem;
        }
        
        .feedback-form label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
        }
        
        .feedback-form input,
        .feedback-form textarea {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
            margin-bottom: 1rem;
        }
        
        .feedback-form textarea {
            min-height: 150px;
            resize: vertical;
        }
        
        .btn.submit-feedback {
            background: linear-gradient(135deg, #4CAF50, #8BC34A);
            display: block;
            margin: 1rem auto;
            padding: 1rem 2rem;
            font-size: 1.1rem;
        }
        
        /* ÂìçÂ∫îÂºè‰ºòÂåñ */
        @media (max-width: 768px) {
            .container {
                padding: 0 1rem;
            }
            
            .instructions {
                padding: 1.5rem;
            }
            
            .instructions h3 {
                font-size: 1.5rem;
            }
            
            .instructions li {
                font-size: 1rem;
            }
            
            .student-management {
                padding: 1.5rem;
            }
            
            .input-group {
                flex-direction: column;
            }
            
            .student-summary {
                flex-direction: column;
                gap: 1rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>ÊïôÂ∏àÂ∑•ÂÖ∑ÁÆ±</h1>
        <p>‰∏ì‰∏∫ÊïôÂ∏àËÆæËÆ°ÁöÑÂÆûÁî®Â∑•ÂÖ∑ÈõÜÂêà</p>
    </header>
    
    <div class="container">
        <!-- Â∑•ÂÖ∑Âç°Áâá -->
        <div class="tools-container">
            <div class="tool-card" id="sound-detector-card">
                <div class="tool-icon">üîä</div>
                <h2>Â£∞Èü≥Ê£ÄÊµãÂô®</h2>
                <p>ÂÆûÊó∂Ê£ÄÊµãÁéØÂ¢ÉÂ£∞Èü≥Âº∫Â∫¶ÔºåÂ£∞Èü≥Ë∂äÈ´òÂ∞èÁêÉË∂äÈ´ò</p>
                <button onclick="navigateTo('sound-detector.html')">Á´ãÂç≥‰ΩøÁî®</button>
            </div>
            
            <div class="tool-card" id="roll-call-card">
                <div class="tool-icon">üé≤</div>
                <h2>ÈöèÊú∫ÁÇπÂêçÂô®</h2>
                <p>ÈöèÊú∫ÈÄâÊã©Â≠¶ÁîüÂõûÁ≠îÈóÆÈ¢òÔºåÂ¢ûÂä†ËØæÂ†Ç‰∫íÂä®</p>
                <button onclick="navigateTo('roll-call.html')">Á´ãÂç≥‰ΩøÁî®</button>
            </div>
            
            <div class="tool-card" id="timer-card">
                <div class="tool-icon">‚è±Ô∏è</div>
                <h2>ËØæÂ†ÇËÆ°Êó∂Âô®</h2>
                <p>ÁÆ°ÁêÜËØæÂ†ÇÊ¥ªÂä®Êó∂Èó¥ÔºåÊèêÈ´òÊïôÂ≠¶ÊïàÁéá</p>
                <button onclick="navigateTo('timer.html')">Á´ãÂç≥‰ΩøÁî®</button>
            </div>
            
            <div class="tool-card" id="grouping-card">
                <div class="tool-icon">üë•</div>
                <h2>Â∞èÁªÑÂàÜÁªÑÂô®</h2>
                <p>ÈöèÊú∫ÂàÜÁªÑÂ≠¶ÁîüÔºå‰æø‰∫éÂ∞èÁªÑÊ¥ªÂä®</p>
                <button onclick="navigateTo('grouping.html')">Á´ãÂç≥‰ΩøÁî®</button>
            </div>
            
            <div class="tool-card" id="whiteboard-card">
                <div class="tool-icon">‚úèÔ∏è</div>
                <h2>ÁîµÂ≠êÁôΩÊùø</h2>
                <p>Âú®Á∫øÁªòÂà∂ÂíåÊºîÁ§∫ÔºåÊîØÊåÅÂ§öÁÇπËß¶Êéß</p>
                <button onclick="navigateTo('whiteboard.html')">Á´ãÂç≥‰ΩøÁî®</button>
            </div>
            
            <div class="tool-card" id="tracker-card">
                <div class="tool-icon">üìà</div>
                <h2>ËØæÂ†ÇË°®Áé∞ËÆ∞ÂΩïÂô®</h2>
                <p>ËÆ∞ÂΩïÂ≠¶ÁîüËØæÂ†ÇË°®Áé∞ÔºåÊèêÂçáÊïôÂ≠¶ÊïàÊûú</p>
                <button onclick="navigateTo('classroom-tracker.html')">Á´ãÂç≥‰ΩøÁî®</button>
            </div>
        </div>
        
        <!-- ÂàáÊç¢Â≠¶ÁîüÁÆ°ÁêÜÊåâÈíÆ -->
        <button id="toggleStudentsBtn" class="btn toggle-students">ÁÆ°ÁêÜÂ≠¶Áîü‰ø°ÊÅØ</button>
        
        <!-- Â≠¶ÁîüÁÆ°ÁêÜÂå∫Âüü -->
        <div class="student-management" id="studentManagement">
            <h2>Â≠¶ÁîüÁÆ°ÁêÜ</h2>
            
            <div class="student-input-section">
                <div class="input-group">
                    <input type="text" id="studentId" placeholder="Â≠¶Âè∑ÔºàÂèØÈÄâÔºâ">
                    <input type="text" id="studentName" placeholder="Â≠¶ÁîüÂßìÂêç">
                    <button id="addStudentBtn" class="btn add">Ê∑ªÂä†Â≠¶Áîü</button>
                </div>
                
                <div class="batch-import">
                    <h3>ÊâπÈáèÂØºÂÖ•ÔºàCSVÊ†ºÂºèÔºöÂ≠¶Âè∑,ÂßìÂêçÔºâ</h3>
                    <textarea id="csvInput" placeholder="‰æãÂ¶ÇÔºö
2021001,Âº†‰∏â
2021002,ÊùéÂõõ
2021003,Áéã‰∫î"></textarea>
                    <button id="importBtn" class="btn import">ÂØºÂÖ•CSV</button>
                </div>
                
                <div class="file-import">
                    <h3>Êñá‰ª∂ÂØºÂÖ•ÔºàÊîØÊåÅCSV„ÄÅTXT„ÄÅExcelÊ†ºÂºèÔºâ</h3>
                    <input type="file" id="fileInput" accept=".csv,.txt,.xlsx,.xls">
                    <button id="importFileBtn" class="btn import">ÂØºÂÖ•Êñá‰ª∂</button>
                    <div id="fileInfo" style="margin-top: 0.5rem; font-size: 0.9rem; color: #666;"></div>
                </div>
                
                <button id="clearStudentsBtn" class="btn clear">Ê∏ÖÁ©∫Â≠¶ÁîüÂàóË°®</button>
            </div>
            
            <div class="student-list-container">
                <div id="studentList">
                    <div class="empty-list">ÊöÇÊó†Â≠¶ÁîüÔºåËØ∑Ê∑ªÂä†Â≠¶Áîü</div>
                </div>
            </div>
            
            <div class="student-summary">
                <div class="summary-card">
                    <div class="summary-value" id="totalStudents">0</div>
                    <div class="summary-label">ÊÄªÂ≠¶ÁîüÊï∞</div>
                </div>
                <div class="summary-card">
                    <div class="summary-value" id="totalGroups">0</div>
                    <div class="summary-label">Âª∫ËÆÆÂàÜÁªÑÊï∞</div>
                </div>
            </div>
        </div>
        
        <!-- ÂèçÈ¶àÂª∫ËÆÆÊåâÈíÆ -->
        <button id="feedbackBtn" class="btn feedback">ÂèçÈ¶àÂª∫ËÆÆ</button>
    </div>
    
    <!-- ÂèçÈ¶àÊ®°ÊÄÅÊ°Ü -->
    <div class="modal" id="feedbackModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ÂèçÈ¶àÂª∫ËÆÆ</h2>
                <button class="close-modal">&times;</button>
            </div>
            
            <div class="feedback-form">
                <label for="feedbackName">ÊÇ®ÁöÑÂßìÂêç:</label>
                <input type="text" id="feedbackName" placeholder="ËØ∑ËæìÂÖ•ÊÇ®ÁöÑÂßìÂêç">
                
                <label for="feedbackEmail">ÊÇ®ÁöÑÈÇÆÁÆ±:</label>
                <input type="email" id="feedbackEmail" placeholder="ËØ∑ËæìÂÖ•ÊÇ®ÁöÑÈÇÆÁÆ±">
                
                <label for="feedbackSubject">‰∏ªÈ¢ò:</label>
                <input type="text" id="feedbackSubject" placeholder="ËØ∑ËæìÂÖ•ÂèçÈ¶à‰∏ªÈ¢ò">
                
                <label for="feedbackMessage">ÂèçÈ¶àÂÜÖÂÆπ:</label>
                <textarea id="feedbackMessage" placeholder="ËØ∑ËæìÂÖ•ÊÇ®ÁöÑÂª∫ËÆÆÊàñÊÑèËßÅ..."></textarea>
                
                <button id="submitFeedbackBtn" class="btn submit-feedback">Êèê‰∫§ÂèçÈ¶à</button>
            </div>
        </div>
    </div>
    
    <div class="container">
        <div class="instructions">
            <h3>‰ΩøÁî®ËØ¥Êòé</h3>
            <ol>
                <li><strong>Â≠¶ÁîüÁÆ°ÁêÜ</strong> - ÁÇπÂáª"ÁÆ°ÁêÜÂ≠¶Áîü‰ø°ÊÅØ"ÊåâÈíÆÊòæÁ§∫Â≠¶ÁîüÁÆ°ÁêÜÁïåÈù¢ÔºåÊîØÊåÅÂçï‰∏™Ê∑ªÂä†„ÄÅÊâπÈáèÂØºÂÖ•ÂíåÊñá‰ª∂ÂØºÂÖ•</li>
                <li><strong>Â£∞Èü≥Ê£ÄÊµãÂô®</strong> - ÂÆûÊó∂Ê£ÄÊµãÁéØÂ¢ÉÂ£∞Èü≥Âº∫Â∫¶ÔºåÂ£∞Èü≥Ë∂äÈ´òÂ∞èÁêÉË∂äÈ´òÔºåÂèØÁî®‰∫éËØæÂ†ÇÊ¥ªË∑ÉÂ∫¶ÁõëÊµã</li>
                <li><strong>ÈöèÊú∫ÁÇπÂêçÂô®</strong> - ÈöèÊú∫ÈÄâÊã©Â≠¶ÁîüÂõûÁ≠îÈóÆÈ¢òÔºåÂ¢ûÂä†ËØæÂ†Ç‰∫íÂä®ÔºåÊîØÊåÅÂØºÂÖ•Â≠¶ÁîüÂêçÂçï</li>
                <li><strong>ËØæÂ†ÇËÆ°Êó∂Âô®</strong> - ÁÆ°ÁêÜËØæÂ†ÇÊ¥ªÂä®Êó∂Èó¥ÔºåÊèêÈ´òÊïôÂ≠¶ÊïàÁéáÔºåÊîØÊåÅÂÖ®Â±èÊ®°ÂºèÂíåÈ¢ÑËÆæÊó∂Èó¥</li>
                <li><strong>Â∞èÁªÑÂàÜÁªÑÂô®</strong> - ÈöèÊú∫ÂàÜÁªÑÂ≠¶ÁîüÔºå‰æø‰∫éÂ∞èÁªÑÊ¥ªÂä®ÔºåÊîØÊåÅËá™ÂÆö‰πâÂàÜÁªÑ‰∫∫Êï∞</li>
                <li><strong>ÁîµÂ≠êÁôΩÊùø</strong> - Âú®Á∫øÁªòÂà∂ÂíåÊºîÁ§∫ÔºåÊîØÊåÅÂ§öÁÇπËß¶Êéß„ÄÅÂ§öÁßçÈ¢úËâ≤ÂíåÁ∫øÊù°Á≤óÁªÜË∞ÉËäÇ</li>
                <li><strong>ËØæÂ†ÇË°®Áé∞ËÆ∞ÂΩïÂô®</strong> - ËÆ∞ÂΩïÂ≠¶ÁîüËØæÂ†ÇË°®Áé∞ÔºåÂ∏ÆÂä©ÊïôÂ∏à‰∫ÜËß£Â≠¶ÁîüÂèÇ‰∏éÂ∫¶</li>
                <li><strong>ÂèçÈ¶àÂª∫ËÆÆ</strong> - ÁÇπÂáª"ÂèçÈ¶àÂª∫ËÆÆ"ÊåâÈíÆÊèê‰∫§ÊÇ®ÁöÑÂÆùË¥µÊÑèËßÅ</li>
            </ol>
        </div>
    </div>
    
    <footer>
        <p>&copy; 2025 ÊïôÂ∏àÂ∑•ÂÖ∑ÁÆ± - ‰∏ì‰∏∫ÊïôÂ∏àËÆæËÆ°</p>
    </footer>
    
    <script>
        // Ëé∑ÂèñDOMÂÖÉÁ¥†
        const toggleStudentsBtn = document.getElementById('toggleStudentsBtn');
        const studentManagement = document.getElementById('studentManagement');
        const studentId = document.getElementById('studentId');
        const studentName = document.getElementById('studentName');
        const addStudentBtn = document.getElementById('addStudentBtn');
        const csvInput = document.getElementById('csvInput');
        const importBtn = document.getElementById('importBtn');
        const fileInput = document.getElementById('fileInput');
        const importFileBtn = document.getElementById('importFileBtn');
        const clearStudentsBtn = document.getElementById('clearStudentsBtn');
        const studentList = document.getElementById('studentList');
        const totalStudentsEl = document.getElementById('totalStudents');
        const totalGroupsEl = document.getElementById('totalGroups');
        const fileInfo = document.getElementById('fileInfo');
        const feedbackBtn = document.getElementById('feedbackBtn');
        const feedbackModal = document.getElementById('feedbackModal');
        const closeModal = document.querySelector('.close-modal');
        const submitFeedbackBtn = document.getElementById('submitFeedbackBtn');
        
        // ÂàáÊç¢Â≠¶ÁîüÁÆ°ÁêÜÁïåÈù¢ÊòæÁ§∫/ÈöêËóè
        function toggleStudentManagement() {
            studentManagement.classList.toggle('visible');
            toggleStudentsBtn.textContent = studentManagement.classList.contains('visible') ? 
                'ÈöêËóèÂ≠¶ÁîüÁÆ°ÁêÜ' : 'ÁÆ°ÁêÜÂ≠¶Áîü‰ø°ÊÅØ';
        }
        
        // Ê∑ªÂä†Â≠¶Áîü
        function addStudent() {
            const id = studentId.value.trim();
            const name = studentName.value.trim();
            
            if (!name) {
                alert('ËØ∑ËæìÂÖ•Â≠¶ÁîüÂßìÂêç');
                return;
            }
            
            // ‰ΩøÁî®StudentManagerÊù•Â§ÑÁêÜÂ≠¶ÁîüËæìÂÖ•
            const student = { id, name };
            if (StudentManager.addStudent(student)) {
                renderStudentList();
                updateSummary();
                studentId.value = '';
                studentName.value = '';
                studentName.focus();
            } else {
                alert('Â≠¶ÁîüÂ∑≤Â≠òÂú®ÔºàÂ≠¶Âè∑ÊàñÂßìÂêçÈáçÂ§çÔºâ');
            }
        }
        
        // ÊâπÈáèÂØºÂÖ•Â≠¶Áîü
        function importStudents() {
            const csvText = csvInput.value.trim();
            if (csvText === '') {
                alert('ËØ∑ËæìÂÖ•CSVÊï∞ÊçÆ');
                return;
            }
            
            try {
                const students = StudentManager.parseCSV(csvText);
                if (students.length === 0) {
                    alert('Êú™Ëß£ÊûêÂà∞ÊúâÊïàÂ≠¶ÁîüÊï∞ÊçÆ');
                    return;
                }
                
                const addedCount = StudentManager.addStudents(students);
                renderStudentList();
                updateSummary();
                csvInput.value = '';
                alert(`ÊàêÂäüÂØºÂÖ• ${addedCount} ÂêçÂ≠¶Áîü`);
            } catch (e) {
                alert('ÂØºÂÖ•Â§±Ë¥•Ôºö' + e.message);
            }
        }
        
        // Êñá‰ª∂ÂØºÂÖ•Â≠¶Áîü
        function importFromFile() {
            const file = fileInput.files[0];
            if (!file) {
                alert('ËØ∑ÈÄâÊã©‰∏Ä‰∏™Êñá‰ª∂');
                return;
            }
            
            // ÊòæÁ§∫Êñá‰ª∂‰ø°ÊÅØ
            fileInfo.textContent = `Êñá‰ª∂Âêç: ${file.name} | Â§ßÂ∞è: ${(file.size / 1024).toFixed(1)} KB | Á±ªÂûã: ${file.type || 'Êú™Áü•'}`;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const content = e.target.result;
                    let students = [];
                    
                    // Ê†πÊçÆÊñá‰ª∂Á±ªÂûãÂ§ÑÁêÜ
                    if (file.name.endsWith('.csv') || file.name.endsWith('.txt')) {
                        students = StudentManager.parseCSV(content);
                    } else if (file.name.endsWith('.xlsx') || file.name.endsWith('.xls')) {
                        // ÂØπ‰∫éExcelÊñá‰ª∂ÔºåËøôÈáåÁÆÄÂåñÂ§ÑÁêÜ
                        // ÂÆûÈôÖÈ°πÁõÆ‰∏≠ÈúÄË¶Å‰ΩøÁî®xlsxÂ∫ìÔºåËøôÈáåÊèê‰æõ‰∏Ä‰∏™ÂèãÂ•ΩÁöÑÊèêÁ§∫
                        alert('ExcelÊñá‰ª∂ÈúÄË¶Å‰ΩøÁî®‰∏ìÈó®ÁöÑÂ∫ìÂ§ÑÁêÜ„ÄÇ‰∏∫‰∫ÜÊºîÁ§∫ÔºåÊàë‰ª¨Â∞ÜÂ∞ùËØïÂ∞ÜÂÖ∂‰Ωú‰∏∫CSVÂ§ÑÁêÜ„ÄÇÂ¶ÇÊûúÂ§±Ë¥•ÔºåËØ∑Â∞ÜExcelÊñá‰ª∂Âè¶Â≠ò‰∏∫CSVÊ†ºÂºèÂÜçÂØºÂÖ•„ÄÇ');
                        try {
                            students = StudentManager.parseCSV(content);
                        } catch (excelError) {
                            // Â¶ÇÊûúCSVËß£ÊûêÂ§±Ë¥•ÔºåÂ∞ùËØïÂÖ∂‰ªñÊñπÂºè
                            alert('ExcelÊñá‰ª∂Ëß£ÊûêÂ§±Ë¥•„ÄÇËØ∑Â∞ÜExcelÊñá‰ª∂Âè¶Â≠ò‰∏∫CSVÊ†ºÂºèÂÜçÂØºÂÖ•„ÄÇ');
                            return;
                        }
                    } else {
                        alert('‰∏çÊîØÊåÅÁöÑÊñá‰ª∂Ê†ºÂºèÔºåËØ∑‰ΩøÁî®CSV„ÄÅTXTÊàñExcelÊ†ºÂºè');
                        return;
                    }
                    
                    if (students.length === 0) {
                        alert('Êú™Ëß£ÊûêÂà∞ÊúâÊïàÂ≠¶ÁîüÊï∞ÊçÆ');
                        return;
                    }
                    
                    const addedCount = StudentManager.addStudents(students);
                    renderStudentList();
                    updateSummary();
                    fileInput.value = '';
                    fileInfo.textContent = '';
                    alert(`ÊàêÂäüÂØºÂÖ• ${addedCount} ÂêçÂ≠¶Áîü`);
                } catch (e) {
                    alert('ÂØºÂÖ•Â§±Ë¥•Ôºö' + e.message);
                }
            };
            
            // ËØªÂèñÊñá‰ª∂ÂÜÖÂÆπ
            if (file.name.endsWith('.csv') || file.name.endsWith('.txt')) {
                reader.readAsText(file, 'UTF-8');
            } else if (file.name.endsWith('.xlsx') || file.name.endsWith('.xls')) {
                // ExcelÊñá‰ª∂Â∞ùËØï‰ª•ÊñáÊú¨ÊñπÂºèËØªÂèñ
                reader.readAsText(file, 'UTF-8');
            } else {
                alert('‰∏çÊîØÊåÅÁöÑÊñá‰ª∂Ê†ºÂºèÔºåËØ∑‰ΩøÁî®CSV„ÄÅTXTÊàñExcelÊ†ºÂºè');
            }
        }
        
        // Âà†Èô§Â≠¶Áîü
        function removeStudent(index) {
            StudentManager.removeStudent(index);
            renderStudentList();
            updateSummary();
        }
        
        // Ê∏ÖÁ©∫Â≠¶ÁîüÂàóË°®
        function clearStudents() {
            if (confirm('Á°ÆÂÆöË¶ÅÊ∏ÖÁ©∫ÊâÄÊúâÂ≠¶ÁîüÂêóÔºü')) {
                StudentManager.clearStudents();
                renderStudentList();
                updateSummary();
            }
        }
        
        // Ê∏≤ÊüìÂ≠¶ÁîüÂàóË°®
        function renderStudentList() {
            const students = StudentManager.getStudents();
            studentList.innerHTML = '';
            
            if (students.length === 0) {
                studentList.innerHTML = '<div class="empty-list">ÊöÇÊó†Â≠¶ÁîüÔºåËØ∑Ê∑ªÂä†Â≠¶Áîü</div>';
                return;
            }
            
            students.forEach((student, index) => {
                const studentItem = document.createElement('div');
                studentItem.className = 'student-item';
                
                const studentInfo = student.id ? 
                    `<span class="student-info"><span class="student-id">${student.id}</span> - ${student.name}</span>` : 
                    `<span class="student-info">${student.name}</span>`;
                
                studentItem.innerHTML = `
                    ${studentInfo}
                    <button class="remove-student" onclick="removeStudent(${index})">Âà†Èô§</button>
                `;
                studentList.appendChild(studentItem);
            });
        }
        
        // Êõ¥Êñ∞ÁªüËÆ°ÊëòË¶Å
        function updateSummary() {
            const students = StudentManager.getStudents();
            totalStudentsEl.textContent = students.length;
            
            // Âª∫ËÆÆÂàÜÁªÑÊï∞ÔºàÊØèÁªÑ4-6‰∫∫Ôºâ
            const suggestedGroups = Math.max(1, Math.floor(students.length / 5));
            totalGroupsEl.textContent = suggestedGroups;
        }
        
        // ÊòæÁ§∫ÂèçÈ¶àÊ®°ÊÄÅÊ°Ü
        function showFeedbackModal() {
            feedbackModal.style.display = 'flex';
        }
        
        // ÈöêËóèÂèçÈ¶àÊ®°ÊÄÅÊ°Ü
        function hideFeedbackModal() {
            feedbackModal.style.display = 'none';
        }
        
        // Êèê‰∫§ÂèçÈ¶à
        function submitFeedback() {
            const name = document.getElementById('feedbackName').value.trim();
            const email = document.getElementById('feedbackEmail').value.trim();
            const subject = document.getElementById('feedbackSubject').value.trim();
            const message = document.getElementById('feedbackMessage').value.trim();
            
            if (!name || !email || !subject || !message) {
                alert('ËØ∑Â°´ÂÜôÊâÄÊúâÂøÖÂ°´Â≠óÊÆµ');
                return;
            }
            
            // Êõ¥ÂÆΩÊùæÁöÑÈÇÆÁÆ±È™åËØÅÔºàÊîØÊåÅÊõ¥Â§öÊ†ºÂºèÔºåÂåÖÊã¨a13662282499@163.comËøôÊ†∑ÁöÑÊ†ºÂºèÔºâ
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                alert('ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÈÇÆÁÆ±Âú∞ÂùÄ');
                return;
            }
            
            // ÊûÑÈÄ†mailtoÈìæÊé•
            const mailtoLink = `mailto:crisweiming@hotmail.com?subject=${encodeURIComponent('„ÄêÊïôÂ∏àÂ∑•ÂÖ∑ÁÆ±ÂèçÈ¶à„Äë' + subject)}&body=${encodeURIComponent(`ÂèçÈ¶àËÄÖ: ${name}\nÈÇÆÁÆ±: ${email}\n\nÂèçÈ¶àÂÜÖÂÆπ:\n${message}\n\n--------\nÊ≠§ÈÇÆ‰ª∂Êù•Ëá™ÊïôÂ∏àÂ∑•ÂÖ∑ÁÆ±ÂèçÈ¶àÁ≥ªÁªü`)}`;
            
            // Â∞ùËØïÊâìÂºÄÈÇÆ‰ª∂ÂÆ¢Êà∑Á´Ø
            try {
                window.open(mailtoLink, '_blank');
                alert('ÊÑüË∞¢ÊÇ®ÁöÑÂèçÈ¶àÔºÅÈÇÆ‰ª∂ÂÆ¢Êà∑Á´ØÂ∑≤ÊâìÂºÄÔºåËØ∑ÂèëÈÄÅÈÇÆ‰ª∂„ÄÇ\nÂ¶ÇÊûúÊú™Ëá™Âä®ÊâìÂºÄÈÇÆ‰ª∂ÂÆ¢Êà∑Á´ØÔºåËØ∑ÊâãÂä®ÂèëÈÄÅÈÇÆ‰ª∂Ëá≥: crisweiming@hotmail.com');
                hideFeedbackModal();
                
                // Ê∏ÖÁ©∫Ë°®Âçï
                document.getElementById('feedbackName').value = '';
                document.getElementById('feedbackEmail').value = '';
                document.getElementById('feedbackSubject').value = '';
                document.getElementById('feedbackMessage').value = '';
            } catch (e) {
                alert('Êó†Ê≥ïËá™Âä®ÊâìÂºÄÈÇÆ‰ª∂ÂÆ¢Êà∑Á´ØÔºåËØ∑ÊâãÂä®ÂèëÈÄÅÈÇÆ‰ª∂Ëá≥: crisweiming@hotmail.com\n\nÈÇÆ‰ª∂‰∏ªÈ¢ò: „ÄêÊïôÂ∏àÂ∑•ÂÖ∑ÁÆ±ÂèçÈ¶à„Äë' + subject + '\n\nÈÇÆ‰ª∂ÂÜÖÂÆπ:\nÂèçÈ¶àËÄÖ: ' + name + '\nÈÇÆÁÆ±: ' + email + '\n\nÂèçÈ¶àÂÜÖÂÆπ:\n' + message);
                hideFeedbackModal();
            }
        }
        
        // ÂØºËà™Âà∞ÂÖ∂‰ªñÈ°µÈù¢
        function navigateTo(page) {
            window.location.href = page;
        }
        
        // ÂàùÂßãÂåñ
        function init() {
            // ÂàùÂßãÂåñÂ≠¶ÁîüÁÆ°ÁêÜÂô®
            StudentManager.init();
            
            // Ê∏≤ÊüìÂ≠¶ÁîüÂàóË°®
            renderStudentList();
            updateSummary();
            
            // ÁªëÂÆö‰∫ã‰ª∂ÁõëÂê¨Âô®
            toggleStudentsBtn.addEventListener('click', toggleStudentManagement);
            addStudentBtn.addEventListener('click', addStudent);
            
            studentName.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    addStudent();
                }
            });
            
            importBtn.addEventListener('click', importStudents);
            importFileBtn.addEventListener('click', importFromFile);
            clearStudentsBtn.addEventListener('click', clearStudents);
            
            // Êñá‰ª∂ÈÄâÊã©ÂèòÂåñÊó∂ÊòæÁ§∫Êñá‰ª∂‰ø°ÊÅØ
            fileInput.addEventListener('change', function() {
                if (this.files.length > 0) {
                    const file = this.files[0];
                    fileInfo.textContent = `Êñá‰ª∂Âêç: ${file.name} | Â§ßÂ∞è: ${(file.size / 1024).toFixed(1)} KB | Á±ªÂûã: ${file.type || 'Êú™Áü•'}`;
                } else {
                    fileInfo.textContent = '';
                }
            });
            
            // ÂèçÈ¶àÊ®°ÊÄÅÊ°Ü‰∫ã‰ª∂
            feedbackBtn.addEventListener('click', showFeedbackModal);
            closeModal.addEventListener('click', hideFeedbackModal);
            submitFeedbackBtn.addEventListener('click', submitFeedback);
            
            // ÁÇπÂáªÊ®°ÊÄÅÊ°ÜÂ§ñÈÉ®ÂÖ≥Èó≠
            window.addEventListener('click', (e) => {
                if (e.target === feedbackModal) {
                    hideFeedbackModal();
                }
            });
        }
        
        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂàùÂßãÂåñ
        window.onload = init;
    </script>
</body>
</html>